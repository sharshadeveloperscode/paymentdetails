
@{
    ViewBag.Title = "Billings";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .fullpage {
        width: 100%;
        height: 100vh;
        top: 0px;
        left: 0px;
        position: fixed;
        background: rgba(0, 0, 0, 0.98);
        z-index: 99999;
    }

    .popblock {
        width: 500px;
        position: relative;
        margin: 100px auto;
        background: #fff;
    }

        .popblock > .col-md-12 {
            background: #fff;
        }

    .logo {
        margin: 0px auto;
        display: block;
        width: 110px;
    }

    .page-form {
        padding: 20px;
    }

    .popblock h1 {
        text-align: center;
    }
</style>

<section class="content-header">
    <h1>
        Billings
    </h1>
    <ol class="breadcrumb">
        <li><a href=""><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Billings</li>
    </ol>
</section>

<div id="preloader" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: #fefefe; z-index: 99; height: 110vh;">
    <div id="status" style="width:100%;height:100%; text-align: center; position: absolute; left: 0; top: 30%; background-repeat: no-repeat; background-size: cover cover; background-position: center; margin: 0px 0 0 36px;">
        <div class="preloader-logo"></div>
        <p class="center-text smaller-text" id="p1" style="margin: 0 24px 10px !important;">
            <h2 id="lblLoader"> Loading .. </h2><br />
            <img src="~/img/preload.gif" />
        </p>
    </div>
</div>
<div id="loginpopup"></div>
<section class="content">

    <div id="modal2" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <!--  SIGN IN PAGE -->

                <div class="modal-header">
                    <div class="alert alert-danger" style="display: none;" id="error_msg_login"></div>
                    <div class="alert alert-info" style="display: none;" id="success_msg_login"></div>
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>-->
                    <h4 class="modal-title">User booking</h4>
                </div>
                <form method="POST">
                    <div class="modal-body">
                        <div class="form-group" id="NameandMail">

                        </div>
                        <div class="form-group" id="txtservicename">


                        </div>


                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3">
                            <div class="form-group" id="txtDate">
                                <label for="service name">Date</label>

                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group" id="txtTime">
                                <label for="service name">Time</label>

                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group" id="txtDuration">
                                <label for="service name">Duration</label>

                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group" id="txtStaffName">
                                <label for="service name">Staff Name</label>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div id="txtBookedon">
                            <label for="service name"> <i class="fa fa-pencil" aria-hidden="true"></i> Booked on</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3" id="paidstatus"><label style="margin-left:36px;">Service Charge</label></div>
                        <div class="col-md-9" id="PaymentStatus">

                        </div>
                    </div>
                    @*<div class="container" style="margin-top:10px;">
                            <div class="col-md-4">
                                <button type="button" id="btnClose" class="btn btn-default" data-dismiss="modal">Add New Service</button>
                            </div>
                        </div>*@
                    <div class="col-md-12">
                        <div class="row" style="margin-top:10px; margin-left:170px;">

                            <div class="col-md-3" id="btnComplete">

                            </div>

                            <div class="col-md-3" id="btnNoshow">

                            </div>
                            <div class="col-md-3" id="btnCancel">

                            </div>

                        </div>
                    </div>

                </form>

                <!--END SIGN IN PAGE  -->
                <div class="modal-footer">
                    <label id="lblSaveFile Updated Successfully"></label>
                    <button type="button" id="btnClose" class="btn btn-default" style="margin-top:10px;" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>


    <div class="row">
        <div class="col-xs-12">
            <div class="box">

                <!-- /.box-header -->
                <div class="box-body table-responsive">
                    <div id="dvErrorStatus" style="display:none" class="alert alert-danger alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                        <label id="lblBillings"></label>
                    </div>
                    <div id="dvSuccess" style="display:none" class="alert alert-success alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                        <label id="lbl_status"></label>
                    </div>
                </div>

                @*<div class="col-lg-12 form-control">
                        <table>
                            <tr>

                                <td>
                                    <div class="col-md-3 " style="margin-right:99px;">
                                        <select id="ddlBookings">
                                            <option value="0">All Bookings</option>
                                            <option value="1">Appointment Bookings</option>
                                            <option value="2">eVoucher Bookings</option>
                                        </select>
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-3 " style="margin-right:99px;">
                                        <select id="ddlAlltype" onchange="">
                                            <option value="0">All Type</option>
                                            <option value="1">Unconfirmed</option>
                                            <option value="2">Confirmed</option>
                                            <option value="3">Cancelled</option>
                                            <option value="4">Completed</option>
                                            <option value="5">Not Shown</option>
                                        </select>
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-3 " style="margin-right:99px;">
                                        <input type="text" id="txtdate" placeholder="Select Date" />
                                    </div>
                                </td>
                                <td>

                                </td>
                            </tr>
                        </table>
                    </div>*@
                @*<table>
                        <tr>
                            <td>
                                <select id="ddlBookings">
                                    <option value="0">All Bookings</option>
                                </select>
                                <select id="ddlAlltype">
                                    <option value="0">All Type</option>
                                </select>
                                <input type="text" id="txtdate" />
                                    <input type="radio" name="Excel" value="Excel" checked> Excel
                                    <input type="radio" name="Excel" value="Pdf"> Pdf
                                <input type="button" value="Export" style="color:blue" />
                            </td>
                        </tr>
                    </table>*@

                <div class="box-body table-responsive">
                    <div class="nav-tabs-custom">
                        <div class="tab-content">
                            <div class="row">
                                <input type="button" value="Back" style="float:right; width:100px; margin-top: -10px;" class="btn btn-danger" onclick="window.location.href='@Url.Action("BusinessDashboard", "Salon")';" />
                                <input type="text" id="txtSalonId" hidden />
                                <br />
                                <br />
                                <div class="col-md-12">
                                    <div class="col-md-3">
                                        <select id="ddlAllBooking" onchange="GetdateBasedonDateRange()" style="" class="form-control">
                                            <option value="0">All bookings</option>
                                            <option value="1">Appointmnet Bookings</option>
                                            @*<option value="2">EVoucher Bookings</option>*@

                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <select id="ddlAllType" style="" class="form-control" onchange="GetdateBasedonDateRange()">
                                            <option value="0">All Type</option>
                                            <option value="1">Confirmed</option>
                                            <option value="2">Cancelled</option>
                                            @*<option value="3">Not Shown</option>*@
                                            <option value="4">Completed</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="text" style="" placeholder="From Date" onchange="GetdateBasedonDateRange()" class="form-control" id="txtFromDate" />
                                    </div>
                                    <div class="col-md-3">
                                        <input type="text" style="" placeholder="To Date" onchange="GetdateBasedonDateRange()" class="form-control" id="txtToDate" />
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                    <table id="tblBillings" style="width: 100%" class="table table-bordered table-hover dataTable">
                        <thead>
                            <tr>
                                <th>Booking Id</th>
                                <th>Booking Date</th>
                                <th>Name</th>
                                <th>Service</th>
                                <th>Price</th>
                                <th>Booking Type</th>
                                <th>Evoucher Number</th>
                                <th>Service Status</th>
                                <th>Payment Status</th>
                            </tr>
                        </thead>
                        <tbody id="tblBillingsBody"></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>



</section>
<script type="text/javascript">


    var UserId = localStorage.getItem("UserId");
    window.onload = function () {
        GetSalonId()
        //  GetdateBasedonDateRange();

        GetServerDateTime()
        $('#txtFromDate').datepicker({ autoclose: true });
        $('#txtToDate').datepicker({ autoclose: true });
        var d = new Date();
        var today = ("0" + (d.getMonth() + 1)).slice(-2) + "/" + ("0" + d.getDate()).slice(-2) + "/" + d.getFullYear();
        $("#txtFromDate").val(today);
        $("#txtToDate").val(today);
        GetdateBasedonDateRange();
    }

    function GetSalonId() {

        $.ajax({
            type: "GET",
            url: URLLink + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                CancellationPolicy(SalonsId)
            }
        })


    }
    function AllType() {
        if ($("#lblBillings").show()) {
            $("#dvSuccess").css({ display: "none" });
            $("#dvErrorStatus").css({ display: "none" });

        }
        var status = $('#ddlAllType').val()
        $.ajax({
            type: "GET",
            url: URLLink + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;


                $.ajax({
                    type: 'GET',
                    url: URLLink + "api/Billings/GetCompleteDetailsBasedOnSalonsId",
                    data: { "SalonsId": SalonsId, "IsActive": status },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    xhrFields: {
                        withCredentials: false
                    },
                    success: function (json) {

                        if (json[0].Message == "Error") {
                            $('#tblBillings').hide();
                            $("#dvSuccess").css({ display: "none" });
                            $("#dvErrorStatus").css({ display: "block" });
                            $('#lblBillings').text("Error");

                        }
                        else if (json[0].Message == "NoData") {
                            $('#tblBillings').hide();
                            //$("#dvSuccess").css({ display: "none" });
                            //$("#dvErrorStatus").css({ display: "block" });
                            //$('#lblBillings').text("No Data");
                        }

                        else if (json[0].Message == "Success") {
                            $('#tblBillings').show();
                            if ($.fn.dataTable.isDataTable('#tblBillings')) {
                                $('#tblBillings').DataTable().destroy();
                            }
                            $('#tblBillingsBody').empty();
                            for (var i = 0; i < json.length; i++) {


                                // $("#NameandMail").val(json[i].Email);
                                // alert(json[i].Email);
                                //  $('#txtservicename').val(json[i].TreatmentTitle);
                                tr = $('<tr/>');
                                var date1 = new Date(json[i].BookingDate);
                                var date2 = date1.getFullYear() + "-" + parseInt(date1.getMonth() + 1) + "-" + date1.getDate();
                                tr.append("<td>" + json[i].BookingsId + "</td>");
                                tr.append("<td>" + date2 + "  " + json[i].BookingTime + " </td>");
                                tr.append("<td>" + json[i].FirstName + " " + json[i].LastName + "</td>");
                                tr.append("<td>" + json[i].TreatmentTitle + "</td>");
                                tr.append("<td>" + json[i].Price + "</td>");
                                if (json[i].IsActive == 1) {
                                    tr.append("<td><a href='#'  class='btn btn-success''>Confirmed </a></td>");
                                }
                                if (json[i].IsActive == 2) {
                                    tr.append("<td><a href='#'  class='btn btn-danger''>Cancelled </a></td>");
                                }
                                if (json[i].IsActive == 3) {
                                    tr.append("<td><a href='#'  class='btn btn-danger''>Pending </a></td>");
                                }
                                if (json[i].IsActive == 4) {
                                    tr.append("<td><a href='#'  class='btn btn-primary''>Completed </a></td>");
                                }


                                tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2"  onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success" style="width:100px;">' + json[i].PaymentStatus + '</a></td>');

                                //tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success">' + json[i].PaymentStatus + '</a></td>');

                                $('#tblBillings').append(tr);
                            }
                            $('#tblBillings').DataTable({
                                select: {
                                    style: 'multi'
                                },
                                dom: 'Bfrtip',
                                buttons: [
                                     'excel', 'pdf'
                                ],
                                select: true
                            });
                        }
                    },
                    error: function (err) {
                        $("#dvSuccess").css({ display: "none" });
                        $("#dvErrorStatus").css({ display: "block" });
                        $('#tblSalonComment').text(err.StatusText);
                    }
                });

            }
        });

    }
    function GetAll() {
        $.ajax({
            type: "GET",
            url: URLLink + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                $.ajax({
                    type: 'GET',
                    url: URLLink + "api/Billings/ListofBookingsbasedonSalonsId",
                    data: { "SalonsId": SalonsId },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    xhrFields: {
                        withCredentials: false
                    },
                    success: function (json) {
                        console.log(json);
                        if (json[0].Message == "Error") {
                            $('#tblBillings').hide();
                            $("#dvSuccess").css({ display: "none" });
                            $("#dvErrorStatus").css({ display: "block" });
                            $('#lblBillings').text("Error");

                        }
                        else if (json[0].Message == "NoData") {
                            $('#tblBillings').hide();
                            //$("#dvSuccess").css({ display: "none" });
                            //$("#dvErrorStatus").css({ display: "block" });
                            //$('#lblBillings').text("No Data");
                        }

                        else if (json[0].Message == "Success") {
                            $('#tblBillings').show();
                            if ($.fn.dataTable.isDataTable('#tblBillings')) {
                                $('#tblBillings').DataTable().destroy();
                            }
                            $('#tblBillingsBody').empty();
                            for (var i = 0; i < json.length; i++) {
                                // $("#NameandMail").val(json[i].Email);
                                // alert(json[i].Email);
                                //  $('#txtservicename').val(json[i].TreatmentTitle);
                                tr = $('<tr/>');
                                var date1 = new Date(json[i].BookingDate);
                                //  var d = new Date(date.split("/").reverse().join("-"));

                                var date2 = date1.getDate() + "-" + parseInt(date1.getMonth() + 1) + "-" + date1.getFullYear();
                                tr.append("<td>" + json[i].BookingsId + "</td>");
                                tr.append("<td>" + date2 + "  " + json[i].BookingTime + " </td>");
                                tr.append("<td>" + json[i].FirstName + " " + json[i].LastName + "</td>");
                                tr.append("<td>" + json[i].TreatmentTitle + "</td>");
                                tr.append("<td>" + json[i].Price + "</td>");
                                // tr.append("<td>" + json[i].PaymentStatus + "</td>");
                                //," + json[i].PaymentType + "
                                //alert(json[i].PaymentType);
                                if (json[i].IsActive == 1) {
                                    tr.append("<td><a href='#'  class='btn btn-success''>Confirmed </a></td>");
                                    tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success">' + json[i].PaymentStatus + '</a></td>');
                                }
                                if (json[i].IsActive == 2) {
                                    tr.append("<td><a href='#'  class='btn btn-danger''>Cancelled </a></td>");
                                    tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success">' + json[i].PaymentStatus + '</a></td>');
                                }
                                if (json[i].IsActive == 3 && json[i].PaymentType == "PAYBYPAYPAL") {
                                    tr.append("<td><a href='#'  class='btn btn-danger''>No Show </a></td>");
                                    tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success">' + json[i].PaymentStatus + '</a></td>');
                                }
                                else if (json[i].IsActive == 3 && json[i].PaymentType == "PAYATVENUE") {
                                    tr.append("<td><a href='#'  class='btn btn-danger''>No Show </a></td>");
                                    tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-danger">Cancelled </a></td>');
                                }
                                if (json[i].IsActive == 4) {
                                    tr.append("<td><a href='#'  class='btn btn-primary''>Completed </a></td>");
                                    tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success">' + json[i].PaymentStatus + '</a></td>');
                                }

                                $('#tblBillings').append(tr);
                            }
                            $('#tblBillings').DataTable({
                                select: {
                                    style: 'multi'
                                },
                                dom: 'Bfrtip',
                                buttons: [
                                     'excel', 'pdf'
                                ],
                                select: true
                            });
                        }
                    },
                    error: function (err) {
                        $("#dvSuccess").css({ display: "none" });
                        $("#dvErrorStatus").css({ display: "none" });
                        $('#tblSalonComment').text(err.StatusText);
                    }
                });
            }
        });

    }
    function GetdateBasedonDateRange() {
        $('#preloader').hide();

        if ($("#txtFromDate").val() == "") {
            var d = new Date();
            var today = ("0" + (d.getMonth() + 1)).slice(-2) + "/" + ("0" + d.getDate()).slice(-2) + "/" + d.getFullYear();
            $("#txtFromDate").val(today);
        }

        if ($("#txtToDate").val() == "") {
            var d = new Date();
            var today = ("0" + (d.getMonth() + 1)).slice(-2) + "/" + ("0" + d.getDate()).slice(-2) + "/" + d.getFullYear();
            $("#txtToDate").val(today);
        }


        if ($("#ddlAllType").val() != '' && $("#txtFromDate").val() != '' && $("#txtToDate").val() != '') {
            $("#dvErrorStatus").css({ display: "none" });
            $('#lblBillings').text('');
            $.ajax({
                type: "GET",
                url: URLLink + "api/Salons/GetSalonIdByUserId",
                data: { "UserId": UserId },
                cache: false,
                success: function (json) {
                    var SalonsId = json[0].SalonsId;
                    $('#txtSalonId').val(json[0].SalonsId);
                    var date1 = new Date();
                    var date2 = date1.getFullYear() + "-" + date1.getMonth() + "-" + date1.getDate();
                    $.ajax({
                        type: 'GET',
                        url: URLLink + "api/Billings/ListofBookingsBySearch",
                        data: { "SalonsId": SalonsId, "FromDate": $("#txtFromDate").val(), "ToDate": $("#txtToDate").val(), "IsActive": $("#ddlAllType").val(), "BookingType": $('#ddlAllBooking').val() },
                        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                        cache: false,
                        xhrFields: {
                            withCredentials: false
                        },
                        success: function (json) {
                            console.log(json);
                            if ($.fn.dataTable.isDataTable('#tblBillings')) {
                                $('#tblBillings').DataTable().destroy();
                            }
                            $('#tblBillingsBody').empty();
                            if (json[0].Message == "Error") {
                              //  $('#tblBillings').hide();
                                $("#dvSuccess").css({ display: "none" });
                                $("#dvErrorStatus").css({ display: "block" });
                                $('#lblBillings').text("Error");

                            }
                            else if (json[0].Message == "NoData") {
                               // $('#tblBillings').hide();
                                //$("#dvSuccess").css({ display: "none" });
                                //$("#dvErrorStatus").css({ display: "block" });
                                //$('#lblBillings').text("No Data");
                            }

                            else if (json[0].Message == "Success") {

                                $('#tblBillings').show();
                              
                               
                                for (var i = 0; i < json.length; i++) {
                                    // $("#NameandMail").val(json[i].Email);
                                    // alert(json[i].Email);
                                    //  $('#txtservicename').val(json[i].TreatmentTitle);
                                    tr = $('<tr/>');
                                    var date1 = new Date(json[i].BookingDate);
                                    var date2 = date1.getFullYear() + "-" + parseInt(date1.getMonth() + 1) + "-" + date1.getDate();
                                    tr.append("<td>" + json[i].BookingsId + "</td>");
                                    tr.append("<td>" + json[i].mydate + "  " + json[i].BookingTime + " </td>");
                                    tr.append("<td>" + json[i].FirstName + " " + json[i].LastName + "</td>");
                                    tr.append("<td>" + json[i].TreatmentTitle + "</td>");
                                    if (json[i].BookingType != "Evoucher") {
                                        tr.append("<td>" + json[i].ServicePrice + "</td>");
                                    }
                                    else {
                                        tr.append("<td>" + json[i].ServicePrice + "</td>");
                                      //  tr.append("<td>" + json[i].Price + "</td>");
                                    }

                                    tr.append("<td>" + json[i].BookingType + "</td>");
                                    if (json[i].BookingType != "Evoucher") {
                                        tr.append("<td> - </td>");
                                    }
                                    else {
                                        tr.append("<td>" + json[i].EvoucherNumber + "</td>");
                                    }

                                    //," + json[i].PaymentType + "
                                    //alert(json[i].PaymentType);
                                    if (json[i].IsActive == 1) {
                                        if (json[i].BookingType == "Evoucher") {
                                            tr.append("<td><a  style='width:100px;'>Pending </a></td>");
                                        }
                                        else {
                                            tr.append("<td><a   class='' style='width:100px;'>Confirmed </a></td>");
                                        }
                                    }
                                    if (json[i].IsActive == 2) {
                                        tr.append("<td><a  style='width:100px;'>Cancelled </a></td>");
                                    }
                                    if (json[i].IsActive == 4) {
                                        tr.append("<td><a  style='width:100px;'>Completed </a></td>");
                                    }
                                    if (json[i].IsActive == 6) {
                                        tr.append("<td><a   class=''>Confirmed </a></td>");
                                        tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success" style="width:100px;">' + json[i].PaymentStatus + '</a></td>');
                                    }
                                    else {
                                        if (json[i].BookingType == "Evoucher") {

                                            if (json[i].IsActive != 4 && json[i].IsActive != 2) {
                                                tr.append('<td><a href="#" data-toggle="modal"  onclick= "GetEvoucherStatus(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\',\'' + json[i].EvoucherNumber + '\');" class="btn btn-success" style="width:100px;">Reedem</a></td>');
                                            }
                                            else {
                                                tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success" style="width:100px;">' + json[i].PaymentStatus + '</a></td>');
                                            }
                                        }
                                        else {
                                            tr.append('<td><a href="#" data-toggle="modal" data-target="#modal2" onclick= "GetAll1(' + json[i].SalonCheckoutId + ',\'' + json[i].PaymentType + '\', \'' + json[i].PaymentsId + '\', \'' + json[i].IsActive + '\');" class="btn btn-success" style="width:100px;">' + json[i].PaymentStatus + '</a></td>');
                                        }
                                    }
                                    $('#tblBillings').append(tr);
                                }
                              
                            }
                            $('#tblBillings').DataTable({
                                select: {
                                    style: 'multi'
                                },
                                sort: false,
                                dom: 'Bfrtip',
                                buttons: [
                                     'excel', 'pdf'
                                ],
                                select: true
                            });
                        },
                        error: function (err) {
                            $("#dvSuccess").css({ display: "none" });
                            $("#dvErrorStatus").css({ display: "block" });
                            $('#tblSalonComment').text(err.StatusText);
                        }
                    });
                }
            });



        }

        else {
            if ($("#ddlAllType").val() == '') {

                $("#dvSuccess").css({ display: "none" });
                $("#dvErrorStatus").css({ display: "block" });
                $('#lblBillings').text("Please Select All Type");
            }
            else if ($("#txtFromDate").val() == '') {
                $("#dvSuccess").css({ display: "none" });
                $("#dvErrorStatus").css({ display: "block" });
                $('#lblBillings').text("Please Select From Date");
            }
            else if ($("#txtToDate").val() == '') {
                $("#dvSuccess").css({ display: "none" });
                $("#dvErrorStatus").css({ display: "block" });
                $('#lblBillings').text("Please Select To Date");
            }
        }

    }

    function closepopup() {
        $('#loginpopup').hide();
    }


    function GetEvoucherStatus(SalonCheckoutId, PaymentType, PaymentsId, IsActive, EvoucherNumber) {
        $.ajax({
            type: 'GET',
            url: URLLink + 'api/Billings/EvocuherBookingsList?SalonCheckoutId=' + SalonCheckoutId,
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            cache: false,
            xhrFields: {
                withCredentials: false
            },
            success: function (json) {
                console.log(json);
                var content = "<div class='fullpage'>" +
                 "<div class='popblock'>" +
                 "<div class='col-md-12' style='padding:0px;'>" +
                 "<div class='header-logo'>" +
                 "<h3 class='text-center'>User Booking Confirmation</h3>" +
                 "<div class='page-form'>" +
                 "<div class='header-content'>" + "<h4 id='lblEvoucher'>" + EvoucherNumber + "</h4>" + "</div>" +
                 "<div class='body-content'>" +
                 "<div class='form-group'>" +
                 "<div class='input-icon right'>" +
                 "<label id='lblName'>" + json[0].FirstName + "</label> | <label id='lblEmail'>" + json[0].Email + "</label>" +
                 "</div>" +
                 "</div>" +
                 "<div class='form-group'>" +
                 "<div class='input-icon right'>" +
                 "<label>Service Name : </label>" +
                 "<label class='form-control' id='lblLevels' disabled>" + json[0].TreatmentTitle + "</label>" +
                 "</div>" +
                 "</div>" +
                 "<div class='form-group'>" +
                 "<div class='input-icon right'>" +
                 "<label>Employee : </label>" +
                 "<select id='employee_id' class='form-control'></select>" +
                 "<label id='lblDescription' style='color:red;display:none;'>" + "</label>" +
                 "</div>" +
                 "</div>" +
                 "<div class='form-group'>" +
                 "<div class='input-icon right'>" +
                 "<label>Appointment Date : </label>" +
                 "<input type='date' onchange=getSalonTimes(" + json[0].SalonServicesId + ",\'" + json[0].Duration + "\') id='txtAppDate' class='form-control' />" +
                 "<label id='lblDate' style='color:red;display:none;'>" + "</label>" +
                 "<input type='text' id='txtDuration' value='" + json[0].Duration + "' hidden />" +
                 "</div>" +
                 "</div>" +
                 "<div class='form-group'>" +
                 "<div class='input-icon right'>" +
                 "<label>Appointment Time : </label>" +
                 "<select id='ddlBookingServiceTime' class='form-control'></select>" +
                 "<label id='lblAppTime' style='color:red;display:none;'>" + "</label>" +
                 "</div>" +
                 "</div>" +
                 "<div class='btn-group'>" +
                 "<input type='button' style='margin-left: 314px;' onclick='Update(" + SalonCheckoutId + ")' class='btn btn-success' value='SUBMIT' />" +
                 "<input type='button' onclick='closepopup()' style='margin-left: 8px;'  class='btn btn-danger' value='CLOSE' />" +
                 "</div>" +
                 "<div class='clearfix'><label id='lblStatus' style='color:red;'></label>" + "</div>" +
                 "</div>" +
                 "</div>" +
                 "</div>" +
                 "</div>" +
                 "</div>" +
                 "</div>";
                $('#loginpopup').show();
                $('#loginpopup').text("");
                $('#loginpopup').append(content);
                var mp = new Date();
                var tod = mp.getFullYear() + "-" + ("0" + parseInt(mp.getMonth() + 1)).slice(-2) + "-" + ("0" + mp.getDate()).slice(-2);
                $('#txtAppDate').attr("min", tod);
                Employees(json[0].SalonServicesId);
            }
        });

    }

    function Update(id) {
        // alert($('#ddlBookingServiceTime').val());
        if ($('#txtAppDate').val() != '' && $('#ddlBookingServiceTime').val() != '' && $('#ddlBookingServiceTime').val() != 'null' && $('#ddlBookingServiceTime').val() != null) {
            var bookingdate = $('#txtAppDate').val();

            var now = new Date(bookingdate);
            var day = ("0" + now.getDate()).slice(-2);
            var month = ("0" + (now.getMonth() + 1)).slice(-2);
            var today = now.getFullYear() + "-" + (month) + "-" + (day);
            $('#preloader').show();
            $('#loginpopup').hide();
            $('#lblLoader').text("Confirming Your Appointment..")
            $.ajax({
                type: 'GET',
                url: URLLink + 'api/Billings/UpdateBookingStatus?BookingDate=' + today + '&BookingTime=' + $('#ddlBookingServiceTime').val() + '&SalonCheckoutId=' + id + '&EmployeeServicesId=' + $('#employee_id').val(),
                contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                cache: false,
                xhrFields: {
                    withCredentials: false
                },
                success: function (json) {
                    var content = "Dear " + $('#lblName').text();
                    content += "<table border='1'><tr><td colspan='2' align='center'><h3 style='color:green;'>Evoucher Booking Confirmation</h3></td></tr>" +
                        "<tr><td>Evoucher Number</td><td>" + $('#lblEvoucher').text() + "</td></tr>" +
                        "<tr><td>Appointment DateTime</td><td>" + today + " " + $('#ddlBookingServiceTime').val() + "</td></tr>" +
                        "<tr><td>Employee</td><td>" + $('#employee_id option:selected').text() + "</td></tr>" +
                        "<tr><td>Service</td><td>" + $('#lblLevels').text() + "</td></tr>" +
                        "<tr><td>Duration</td><td>" + $('#txtDuration').val() + "</td></tr>" +
                       // "<tr><td>Price </td><td>" + $('#lblLevels').text() + " " + $('#txtDuration').val() + "</td></tr>" +
                        "<tr><td colspan='2'>Thank You.</td></tr>" +
                        "</table>";
                    var email = $('#lblEmail').text();
                    //  var email="sharsha.developerscode@@gmail.com";
                    $.ajax({
                        type: 'GET',
                        url: URLLink + 'api/emailTemplateTypes/SendEmail?Email=' + email + '&Mobile=9000000000&TemplateTypeId=2&Content=' + content + '&Name=' + $('#lblName').text(),
                        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                        cache: false,
                        xhrFields: {
                            withCredentials: false
                        },
                        success: function (json) {
                            $('#preloader').hide();
                            $('#loginpopup').hide();
                            GetdateBasedonDateRange();
                        }
                    });

                }
            });
        }
        else {
            if ($('#txtAppDate').val() == '') {
                $('#lblDate').text("Please Select Date");
                $('#lblDate').css("display", "block");
            }
            else {
                $('#lblAppTime').text("Please Select Time");
                $('#lblAppTime').css("display", "block");
            }
        }

    }
    function getSalonTimes(id, dur) {
        // alert("heello")
        var bookingdate = $('#txtAppDate').val();

        var now = new Date(bookingdate);
        var day = ("0" + now.getDate()).slice(-2);
        var month = ("0" + (now.getMonth() + 1)).slice(-2);
        var duration2 = dur.replace("min", "");
        var today = now.getFullYear() + "-" + (month) + "-" + (day);
        //  alert(id);
        $.ajax({
            type: 'GET',
            url: URLLink + 'api/EmployeeServices/GetDatabyId',
            data: {
                "EmployeeServicesId": $('#employee_id').val()
            },
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },

            success: function (data3) {


                var empsalonid = data3[0].SalonEmployeesId;
                //alert(id);
                //alert(empsalonid);
                //alert(today);
                //alert($('#txtSalonId').val());
                $.ajax({
                    type: 'GET',
                    url: URLLink + 'api/Search/ViewEmployeeAvailableTimings',
                    data: {
                        "SalonServicesId": id,
                        "SalonEmployeesId": empsalonid,
                        "Date": today,
                        "SalonsId": $('#txtSalonId').val()
                    },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    xhrFields: {
                        withCredentials: false
                    },

                    success: function (data) {
                        console.log("timings");
                        console.log(data);
                        if (data[0].Message == "Success") {
                            var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                            //var bookingdate = $('#selectedDate').val();
                            //var Price = $('#original_order' + $('#radioservice:checked').val()).text();

                            //var bdate = new Date(bookingdate);
                            //var count = bdate.getDay();
                            var Price = "0";
                            if (empsalonid == '0') {
                                alert("please select employee");
                            } else {
                                //   $('#selectable').text("");
                                var StartTime = data[0].BStartTime;
                                var EndTime = data[0].BEndTime;
                                var BookedTime = data[0].BookingTime;
                                var MyBlockedServicesIdArr = [];

                                var countvalue = id;
                                var duration = "";// $('#txtDuration' + countvalue).text();
                                duration = duration2;

                                var cleanuptime = data[0].CleanUpTime;
                                cleanuptime = cleanuptime.slice(0, -3);
                                //  alert(duration+" = "+cleanuptime);
                                duration = parseFloat(duration) + parseFloat(cleanuptime);
                                var serverdate = today;

                                var dm = new Date();
                                var servertime = dm.getHours() + ":" + dm.getMinutes();


                                // salon available timings
                                var starttimearray = [];
                                var endtimearray = [];
                                starttimearray = StartTime.split(':');
                                endtimearray = EndTime.split(':');

                                var repeatstarttime = parseInt(starttimearray[0]);
                                var repeatendtime = parseInt(starttimearray[1]);

                                var repeatstarttime2 = parseInt(starttimearray[0]);
                                var repeatendtime2 = parseInt(starttimearray[1]);


                                // total minutes
                                var starttimeminutes = (repeatstarttime * 60) + repeatendtime;
                                var endtimeminutes = (parseInt(endtimearray[0]) * 60) + parseInt(endtimearray[1]);
                                var totalduration = (endtimeminutes - starttimeminutes) / parseInt(duration);


                                var unavailabletime = data[0].UnStartTime;
                                var unavailableendtime = data[0].UnEndTime;

                                // employee unavailability timings
                                var unavaialbalearray = [];
                                unavaialbalearray = unavailabletime.split(':');
                                var unavailablestarttime1 = parseInt(unavaialbalearray[0]);
                                var unavailablestarttime2 = parseInt(unavaialbalearray[1]);

                                var unavailableendtimearray = [];
                                unavailableendtime = unavailableendtime.split(':');
                                var unavailableendtime1 = parseInt(unavailableendtime[0]);
                                var unavailableendtime2 = parseInt(unavailableendtime[1]);

                                var unavailabletotalhourstimingsarray = [];
                                var unavailabletotalminutestimingsarray = [];

                                var unstarttimeminutes = (unavailablestarttime1 * 60) + unavailablestarttime2;
                                var unendtimeminutes = (unavailableendtime1 * 60) + unavailableendtime2;

                                var totalduration2 = (unendtimeminutes - unstarttimeminutes) / parseInt(duration);


                                for (var i = 0; i < totalduration2; i++) {
                                    if (unavailablestarttime2 >= 60) {
                                        unavailablestarttime2 = unavailablestarttime2 - 60;
                                        unavailablestarttime1 = unavailablestarttime1 + 1;
                                        unavailabletotalhourstimingsarray.push(unavailablestarttime1);
                                        unavailabletotalminutestimingsarray.push(unavailablestarttime2);
                                        unavailablestarttime2 = unavailablestarttime2 + parseInt(duration);
                                    } else {
                                        unavailabletotalhourstimingsarray.push(unavailablestarttime1);
                                        unavailabletotalminutestimingsarray.push(unavailablestarttime2);
                                        unavailablestarttime2 = unavailablestarttime2 + parseInt(duration);
                                    }
                                }

                                var openinghoursstarttimearray = [];
                                var openingminutesstarttimearray = [];
                                var dummyarray = [];

                                var startopeninghour1 = parseInt(starttimearray[0]);
                                var startopeningminute1 = parseInt(starttimearray[1]);

                                var endopeninghour2 = parseInt(endtimearray[0]);
                                var endopeningminute2 = parseInt(endtimearray[1]);


                                for (var i = 0; i < totalduration; i++) {
                                    if (startopeningminute1 >= 60) {
                                        var diff = startopeningminute1 / 60;
                                        startopeningminute1 = startopeningminute1 - (60 * parseInt(diff));
                                        startopeninghour1 = startopeninghour1 + parseInt(diff);
                                        openinghoursstarttimearray.push(startopeninghour1);
                                        openingminutesstarttimearray.push(startopeningminute1);
                                        dummyarray.push(i + "-" + startopeningminute1);
                                        startopeningminute1 = startopeningminute1 + parseInt(duration);
                                    } else {
                                        openinghoursstarttimearray.push(startopeninghour1);
                                        openingminutesstarttimearray.push(startopeningminute1);
                                        dummyarray.push(i + "-" + startopeningminute1);
                                        startopeningminute1 = startopeningminute1 + parseInt(duration);
                                    }
                                }
                                //  alert(openingminutesstarttimearray);
                                //if (parseInt(unavaialbalearray[0]) == repeatstarttime && parseInt(unavaialbalearray[1]) == repeatendtime) {
                                //    repeatendtime = repeatendtime + parseInt(duration);
                                //}
                                //else
                                for (var i = 0; i < totalduration; i++) {
                                    for (var j = 0; j < unavailabletotalhourstimingsarray.length; j++) {
                                        //
                                        if (parseInt(unavailabletotalhourstimingsarray[j]) == parseInt(openinghoursstarttimearray[i]) && parseInt(unavailabletotalminutestimingsarray[j]) == parseInt(openingminutesstarttimearray[i])) {
                                            var index = openinghoursstarttimearray.indexOf(parseInt(openinghoursstarttimearray[i]));
                                            openinghoursstarttimearray.splice(index, 1);

                                            var index1 = dummyarray.indexOf(dummyarray[i]);
                                            openingminutesstarttimearray.splice(index1, 1);
                                            // alert(openinghoursstarttimearray);
                                            //   repeatendtime = repeatendtime + parseInt(duration);
                                            //  alert("if");
                                            //   alert(parseInt(unavailabletotalhourstimingsarray[j]) + " == " + parseInt(openinghoursstarttimearray[i]));
                                            //  alert(parseInt(unavailabletotalminutestimingsarray[j]) + " == " + parseInt(openingminutesstarttimearray[i]));
                                        } else {

                                            // $('#selectable').append('<li class="ui-widget-content" id="09:00">' + openinghoursstarttimearray[i] + ':' + openingminutesstarttimearray[i] + '<span class="price pull-right"> £30.00</span></li>');

                                            //   alert("else");
                                            //   alert(parseInt(openinghoursstarttimearray[i]) + " == " + parseInt(openingminutesstarttimearray[i]));
                                            //if (parseInt(endtimearray[0]) == repeatstarttime && repeatendtime > (endtimearray[1] - parseInt(duration))) {
                                            //    repeatendtime = repeatendtime + parseInt(duration);
                                            //}
                                            //else {
                                            //    if (parseInt(repeatendtime) >= 60) {
                                            //        repeatstarttime = repeatstarttime + 1;
                                            //        repeatendtime = repeatendtime - 60;
                                            //        $('#selectable').append('<li class="ui-widget-content" id="09:00">' + repeatstarttime + ':' + repeatendtime + '<span class="price pull-right"> £30.00</span></li>');
                                            //        repeatendtime = repeatendtime + parseInt(duration);
                                            //    }
                                            //    else {
                                            //        $('#selectable').append('<li class="ui-widget-content" id="09:00">' + repeatstarttime + ':' + repeatendtime + '<span class="price pull-right"> £30.00</span></li>');
                                            //        repeatendtime = repeatendtime + parseInt(duration);
                                            //    }
                                            //}

                                        }
                                    }

                                }
                                var LeadTime = data[0].LeadTime;
                                if (LeadTime != "") {
                                    var lastFour = LeadTime.substr(LeadTime.length - 4)
                                    LeadTime = LeadTime.slice(0, -5);

                                } else {
                                    LeadTime = 0;
                                }
                                if (lastFour != "Week") {
                                    LeadTime = 0;
                                }
                                //  alert(LeadTime);
                                //  $('#selectable').text("");
                                var tabsm = '';
                                serverdate = new Date(bookingdate);
                                var newbookingdate = new Date();
                                newbookingdate.setHours("5");
                                newbookingdate.setMinutes("30");
                                newbookingdate.setSeconds("00");
                                // alert(new Date(serverdate));
                                // alert(new Date(newbookingdate));
                                var new1 = newbookingdate.getDate() + "-" + newbookingdate.getMonth() + "-" + newbookingdate.getYear();
                                var new2 = serverdate.getDate() + "-" + serverdate.getMonth() + "-" + serverdate.getYear();
                                //  alert(new1 == new2);
                                for (var k = 0; k < openinghoursstarttimearray.length; k++) {
                                    if (new1 == new2) {

                                        var servertimesarray = [];
                                        servertimesarray = servertime.split(':');
                                        //     alert(servertimesarray)
                                        //   alert(openinghoursstarttimearray)
                                        if (servertimesarray[0] < openinghoursstarttimearray[k]) {
                                            //  alert('came');
                                            //  if(servertimesarray[1]<=openingminutesstarttimearray[k]){
                                            var b = parseInt(openinghoursstarttimearray[k]) + +parseInt(LeadTime);
                                            //  alert(endopeninghour2);
                                            if (b < endopeninghour2) {
                                                var oh = b;
                                                if (oh < 10) {
                                                    oh = "0" + b;
                                                }
                                                var om = openingminutesstarttimearray[k];
                                                if (om < 10) {
                                                    om = "0" + openingminutesstarttimearray[k];
                                                }

                                                tabsm += "<option>" + oh + ":" + om + "</option>";
                                                var lps = "" + oh + ':' + om + "";
                                                MyBlockedServicesIdArr.push(lps);
                                                $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');
                                            }
                                            //}
                                        } else {
                                            if (servertimesarray[0] == openinghoursstarttimearray[k]) {
                                                var b = parseInt(openinghoursstarttimearray[k]) + +parseInt(LeadTime);
                                                if (servertimesarray[1] <= openingminutesstarttimearray[k]) {
                                                    var oh = b;
                                                    if (oh < 10) {
                                                        oh = "0" + b;
                                                    }
                                                    var om = openingminutesstarttimearray[k];
                                                    if (om < 10) {
                                                        om = "0" + openingminutesstarttimearray[k];
                                                    }
                                                    tabsm += "<option>" + oh + ":" + om + "</option>";
                                                    var lps = "" + oh + ':' + om + "";
                                                    MyBlockedServicesIdArr.push(lps);
                                                    $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');
                                                }
                                            }
                                            else {
                                                //  alert('else');

                                            }
                                        }
                                    } else {
                                        var oh = openinghoursstarttimearray[k];
                                        if (oh < 10) {
                                            oh = "0" + openinghoursstarttimearray[k];
                                        }
                                        var om = openingminutesstarttimearray[k];
                                        if (om < 10) {
                                            om = "0" + openingminutesstarttimearray[k];
                                        }
                                        tabsm += "<option>" + oh + ":" + om + "</option>";
                                        var lps = "" + oh + ':' + om + "";
                                        MyBlockedServicesIdArr.push(lps);
                                        $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');

                                    }

                                    //  alert($('#txtSelectedTime'+k).text());
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].BookingTime == MyBlockedServicesIdArr[k]) {
                                            // alert(data[i].BookingTime +" == "+ MyBlockedServicesIdArr[k]);
                                            $('#liselectedtime' + k).hide();
                                            //alert(MyBlockedServicesIdArr);
                                            //var index = MyBlockedServicesIdArr.indexOf(data[i].BookingTime);
                                            //MyBlockedServicesIdArr.splice(index, 1);
                                            // alert(MyBlockedServicesIdArr);
                                        }
                                    }
                                }
                                //$('#ddlBookingServiceTime').text("");
                                // $('#ddlBookingServiceTime').append(tabsm);

                                //var select = document.getElementById('ddlBookingServiceTime');

                                //for (i = 0; i < select.length; i++) {
                                //    for (var k = 0; k < openinghoursstarttimearray.length; k++) {
                                //        if (select.options[i].value == MyBlockedServicesIdArr[k]) {
                                //            select.remove(k);
                                //        }
                                //    }
                                //}


                                for (var k = 0; k < openinghoursstarttimearray.length; k++) {
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].BookingTime == MyBlockedServicesIdArr[k]) {
                                            $('#liselectedtime' + k).hide();
                                            var index = MyBlockedServicesIdArr.indexOf(MyBlockedServicesIdArr[k]);
                                            MyBlockedServicesIdArr.splice(index, 1);
                                            // $('#ddlBookingServiceTime').remove();
                                            //  MyBlockedServicesIdArr.splice(k, 1);
                                        }
                                    }
                                }

                                var mydropdown = "";
                                //  alert(MyBlockedServicesIdArr);
                                for (var i = 0; i < MyBlockedServicesIdArr.length; i++) {
                                    mydropdown += "<option value=" + MyBlockedServicesIdArr[i] + ">" + MyBlockedServicesIdArr[i] + "</option>";
                                }
                                $('#ddlBookingServiceTime').text("");
                                $('#ddlBookingServiceTime').append(mydropdown);
                            }
                        }
                        else {
                            if (data[0].Message == "NoData") {
                                $('#selectable').text("");
                                $('#selectable').append('<li  class="ui-widget-content"><span>Sorry we are closed this day, please choose another day.</span><span class="price pull-right"></span></li>');
                                $('#ddlBookingServiceTime').text("");
                            }
                        }
                    }

                });
            }
        });
    }

    function getSalonTimesold(id) {
        var bookingdate = $('#txtAppDate').val();
        var now = new Date(bookingdate);
        var day = ("0" + now.getDate()).slice(-2);
        var month = ("0" + (now.getMonth() + 1)).slice(-2);
        var dur = $('#txtDuration').val();
        var duration2 = dur.replace("min", "");
        var duration24 = dur.replace("min", "");
        var today = now.getFullYear() + "-" + (month) + "-" + (day);



        $.ajax({
            type: 'GET',
            url: URLLink + 'api/EmployeeServices/GetDatabyId',
            data: {
                "EmployeeServicesId": $('#employee_id').val()
            },
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },

            success: function (data) {

                if (data[0].Message == "Success") {
                    var SalonEmployeesId = data[0].SalonEmployeesId;
                    //  var id = $('#radioservice:checked').val();
                    // alert(id);
                    $.ajax({
                        type: 'GET',
                        url: URLLink + 'api/Search/ViewEmployeeAvailableTimings',
                        data: {
                            "SalonServicesId": id,
                            "SalonEmployeesId": SalonEmployeesId,
                            "Date": today,
                            "SalonsId": $('#txtSalonId').val()
                        },
                        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                        xhrFields: {
                            withCredentials: false
                        },

                        success: function (data) {
                            var myarrays = [];
                            //   alert(data[0].Message);
                            if (data[0].Message == "Success") {


                                var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                                var bookingdate = today;
                                var Price = 0; //$('#original_order' + $('#radioservice:checked').val()).text();

                                var bdate = new Date(bookingdate);
                                var count = bdate.getDay();

                                if ($('#employee_id').val() == '0') {
                                    $('#txtErrorStatus').text('please select employee');
                                    $('#myModal3').css("display", "block");
                                    //alert("please select employee");
                                } else {
                                    $('#selectable').text("");
                                    var StartTime = data[0].BStartTime;
                                    var EndTime = data[0].BEndTime;
                                    var BookedTime = data[0].BookingTime;
                                    //   alert("duration24 "+duration24);
                                    var countvalue = id;// $('#radioservice:checked').val();
                                    var duration = duration24;// $('#txtDuration' + countvalue).text();
                                    // duration = duration.slice(0, -3);

                                    var cleanuptime = data[0].CleanUpTime;
                                    cleanuptime = cleanuptime.slice(0, -3);
                                    //  alert(duration+" = "+cleanuptime);
                                    duration = parseFloat(duration) + parseFloat(cleanuptime);
                                    var serverdate = today;// $('#myselecteddate').val();
                                    //   var servertime = now.getHours() + ":" + now.getMinutes();// $('#myselectedtime').val();
                                    var pm = new Date();
                                    var servertime = ("0" + pm.getHours()).slice(-2) + ":" + ("0" + pm.getMinutes()).slice(-2);// $('#myselectedtime').val();


                                    // salon available timings
                                    var starttimearray = [];
                                    var endtimearray = [];
                                    starttimearray = StartTime.split(':');
                                    endtimearray = EndTime.split(':');

                                    var repeatstarttime = parseInt(starttimearray[0]);
                                    var repeatendtime = parseInt(starttimearray[1]);

                                    var repeatstarttime2 = parseInt(starttimearray[0]);
                                    var repeatendtime2 = parseInt(starttimearray[1]);


                                    // total minutes
                                    var starttimeminutes = (repeatstarttime * 60) + repeatendtime;
                                    var endtimeminutes = (parseInt(endtimearray[0]) * 60) + parseInt(endtimearray[1]);
                                    //alert("sss  " + duration);
                                    var totalduration = (endtimeminutes - starttimeminutes) / parseInt(duration);


                                    var unavailabletime = data[0].UnStartTime;
                                    var unavailableendtime = data[0].UnEndTime;

                                    // employee unavailability timings
                                    var unavaialbalearray = [];
                                    unavaialbalearray = unavailabletime.split(':');
                                    var unavailablestarttime1 = parseInt(unavaialbalearray[0]);
                                    var unavailablestarttime2 = parseInt(unavaialbalearray[1]);

                                    var unavailableendtimearray = [];
                                    unavailableendtime = unavailableendtime.split(':');
                                    var unavailableendtime1 = parseInt(unavailableendtime[0]);
                                    var unavailableendtime2 = parseInt(unavailableendtime[1]);

                                    var unavailabletotalhourstimingsarray = [];
                                    var unavailabletotalminutestimingsarray = [];

                                    var unstarttimeminutes = (unavailablestarttime1 * 60) + unavailablestarttime2;
                                    var unendtimeminutes = (unavailableendtime1 * 60) + unavailableendtime2;

                                    var totalduration2 = (unendtimeminutes - unstarttimeminutes) / parseInt(duration);


                                    for (var i = 0; i < totalduration2; i++) {
                                        if (unavailablestarttime2 >= 60) {
                                            unavailablestarttime2 = unavailablestarttime2 - 60;
                                            unavailablestarttime1 = unavailablestarttime1 + 1;
                                            unavailabletotalhourstimingsarray.push(unavailablestarttime1);
                                            unavailabletotalminutestimingsarray.push(unavailablestarttime2);
                                            unavailablestarttime2 = unavailablestarttime2 + parseInt(duration);
                                        } else {
                                            unavailabletotalhourstimingsarray.push(unavailablestarttime1);
                                            unavailabletotalminutestimingsarray.push(unavailablestarttime2);
                                            unavailablestarttime2 = unavailablestarttime2 + parseInt(duration);
                                        }
                                    }

                                    var openinghoursstarttimearray = [];
                                    var openingminutesstarttimearray = [];
                                    var dummyarray = [];

                                    var startopeninghour1 = parseInt(starttimearray[0]);
                                    var startopeningminute1 = parseInt(starttimearray[1]);

                                    var endopeninghour2 = parseInt(endtimearray[0]);
                                    var endopeningminute2 = parseInt(endtimearray[1]);

                                    // alert(totalduration);
                                    for (var i = 0; i < totalduration; i++) {
                                        if (startopeningminute1 >= 60) {
                                            var diff = startopeningminute1 / 60;
                                            startopeningminute1 = startopeningminute1 - (60 * parseInt(diff));
                                            startopeninghour1 = startopeninghour1 + parseInt(diff);
                                            openinghoursstarttimearray.push(startopeninghour1);
                                            openingminutesstarttimearray.push(startopeningminute1);
                                            dummyarray.push(i + "-" + startopeningminute1);
                                            startopeningminute1 = startopeningminute1 + parseInt(duration);
                                        } else {
                                            openinghoursstarttimearray.push(startopeninghour1);
                                            openingminutesstarttimearray.push(startopeningminute1);
                                            dummyarray.push(i + "-" + startopeningminute1);
                                            startopeningminute1 = startopeningminute1 + parseInt(duration);
                                        }
                                    }
                                    //  alert(openingminutesstarttimearray);
                                    //if (parseInt(unavaialbalearray[0]) == repeatstarttime && parseInt(unavaialbalearray[1]) == repeatendtime) {
                                    //    repeatendtime = repeatendtime + parseInt(duration);
                                    //}
                                    //else
                                    for (var i = 0; i < totalduration; i++) {
                                        for (var j = 0; j < unavailabletotalhourstimingsarray.length; j++) {
                                            //
                                            if (parseInt(unavailabletotalhourstimingsarray[j]) == parseInt(openinghoursstarttimearray[i]) && parseInt(unavailabletotalminutestimingsarray[j]) == parseInt(openingminutesstarttimearray[i])) {
                                                var index = openinghoursstarttimearray.indexOf(parseInt(openinghoursstarttimearray[i]));
                                                openinghoursstarttimearray.splice(index, 1);

                                                var index1 = dummyarray.indexOf(dummyarray[i]);
                                                openingminutesstarttimearray.splice(index1, 1);
                                            } else {
                                            }
                                        }

                                    }
                                    var LeadTime = data[0].LeadTime;
                                    if (LeadTime != "") {
                                        var lastFour = LeadTime.substr(LeadTime.length - 4)
                                        LeadTime = LeadTime.slice(0, -5);
                                    } else {
                                        LeadTime = 0;
                                    }
                                    if (lastFour == "Week") {
                                        LeadTime = parseInt(LeadTime) * 7;
                                    }

                                    if (lastFour == "Days") {
                                        LeadTime = parseInt(LeadTime);
                                    }
                                    //alert(LeadTime);
                                    $('#selectable').text("");
                                    // alert(openinghoursstarttimearray);
                                    for (var k = 0; k < openinghoursstarttimearray.length; k++) {
                                        //  alert('got');
                                        if (serverdate == bookingdate) {
                                            //  alert('came');
                                            var servertimesarray = [];
                                            servertimesarray = servertime.split(':');
                                            if (servertimesarray[0] < openinghoursstarttimearray[k]) {
                                                //  if(servertimesarray[1]<=openingminutesstarttimearray[k]){
                                                var b = parseInt(openinghoursstarttimearray[k]) + +parseInt(LeadTime);
                                                //  alert(endopeninghour2);
                                                if (b < endopeninghour2) {
                                                    var oh = b;
                                                    if (oh < 10) {
                                                        oh = "0" + b;
                                                    }
                                                    var om = openingminutesstarttimearray[k];
                                                    if (om < 10) {
                                                        om = "0" + openingminutesstarttimearray[k];
                                                    }
                                                    var mmm = oh + ":" + om;
                                                    myarrays.push(mmm);
                                                    $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');
                                                }
                                            } else {
                                                if (servertimesarray[0] == openinghoursstarttimearray[k]) {
                                                    var b = parseInt(openinghoursstarttimearray[k]) + +parseInt(LeadTime);
                                                    if (servertimesarray[1] <= openingminutesstarttimearray[k]) {
                                                        var oh = b;
                                                        if (oh < 10) {
                                                            oh = "0" + b;
                                                        }
                                                        var om = openingminutesstarttimearray[k];
                                                        if (om < 10) {
                                                            om = "0" + openingminutesstarttimearray[k];
                                                        }
                                                        var mmm = oh + ":" + om;
                                                        myarrays.push(mmm);
                                                        $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');
                                                    }
                                                }
                                            }
                                        } else {
                                            var oh = openinghoursstarttimearray[k];
                                            if (oh < 10) {
                                                oh = "0" + openinghoursstarttimearray[k];
                                            }
                                            var om = openingminutesstarttimearray[k];
                                            if (om < 10) {
                                                om = "0" + openingminutesstarttimearray[k];
                                            }
                                            var mmm = oh + ":" + om;
                                            myarrays.push(mmm);
                                            $('#selectable').append('<li  class="ui-widget-content" id="liselectedtime' + k + '" onclick="TimeSelected(' + k + ')"><span id="txtSelectedTime' + k + '">' + oh + ':' + om + '</span><span class="price pull-right"> ' + Price + '</span></li>');

                                        }

                                        for (var i = 0; i < data.length; i++) {
                                            // alert(myarrays);
                                            if (data[i].BookingTime == myarrays[i]) {
                                                $('#liselectedtime' + k).hide();
                                                //  var index=myarrays.indexOf(mya)
                                                myarrays.splice(k, 1);
                                            }
                                        }

                                        //for (var d = 0; d < mytimes.length; d++) {
                                        //    if (mytimes[d] == myarrays[d]) {
                                        //        $('#liselectedtime' + k).hide();
                                        //    }
                                        //}
                                    }
                                }

                                var mydropdown = "";
                                //   alert(MyBlockedServicesIdArr.length);
                                for (var i = 0; i < myarrays.length; i++) {
                                    mydropdown += "<option value=" + myarrays[i] + ">" + myarrays[i] + "</option>";
                                }
                                //   alert(mydropdown);
                                $('#ddlBookingServiceTime').text("");
                                $('#ddlBookingServiceTime').append(mydropdown);

                            }
                            else {
                                if (data[0].Message == "NoData") {
                                    $('#selectable').text("");
                                    if ($('#selectedDate').val() != '') {
                                        $('#selectable').append('<li  class="ui-widget-content"><span>Sorry we are closed this day, please choose another day.</span><span class="price pull-right"></span></li>');
                                    }
                                }
                            }
                        }

                    });
                }
            }

        });











    }


    function Employees(SalonServicesId) {
        $.ajax({
            type: 'GET',
            url: URLLink + 'api/Search/EmployeesbasedonSalons?SalonServicesId=' + SalonServicesId,
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },
            success: function (data) {
                $('#employee_id').text("");
                var city = "";
                for (var i = 0; i < data.length; i++) {
                    if (data[i].IsActive == '1') {
                        city += '<option value=' + data[i].EmployeeServicesId + ' >' + data[i].EmployeeName + '</option>';
                    }
                }
                $('#employee_id').append(city);
            }

        })
    }



    function GetAll1(SalonCheckoutId, PaymentType, PaymentsId, IsActive) {
        $.ajax({
            type: 'GET',
            url: URLLink + 'api/Billings/ListofBookings1?SalonCheckoutId=' + SalonCheckoutId,
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            cache: false,
            xhrFields: {
                withCredentials: false
            },
            success: function (json) {

                $('#NameandMail').empty();
                $('#txtservicename').empty();
                $('#txtDate').empty();
                $('#txtTime').empty();
                $('#txtDuration').empty();
                $('#txtStaffName').empty();
                $('#txtBookedon').empty();
                $('#PaymentStatus').empty();
                //   $('#paidstatus').empty();
                $('#btnCancel').empty();
                $('#btnNoshow').empty();
                $('#btnComplete').empty();
                //var btime = [];
                // btime = json[0].BookingDate.split(" ");
                // var bt = [];
                // bt = btime[0].split("/");
                // var mt = bt[1] + "-" + bt[0] + "-" + bt[2];
                console.log(json);
                //alert(json[0].BookingType);
                $('#NameandMail').append('<label for="service name" >' + json[0].FirstName + ' | ' + json[0].Email + '</label>');
                $('#txtservicename').append(' <label for="service name">Service Name</label><input type="text" class="form-control input-md"   value="' + json[0].TreatmentTypeId + ' " readonly >');
                $('#txtDate').append(' <label for="service name">Date</label><input type="text" name="txtDuration"  class="form-control input-md" id="userdate" value="' + json[0].BookingDate + ' " readonly>');
                $('#txtTime').append(' <label for="service name">Time</label><input type="text" name="txtDuration"  class="form-control input-md" id="usertime" value="' + json[0].BookingTime + ' " readonly>');
                $('#txtDuration').append(' <label for="service name">Duration</label><input type="text" name="txtDuration"  class="form-control input-md" value="' + json[0].Duration + ' " readonly>');
                $('#txtStaffName').append(' <label for="service name">Staff Name</label><input type="text" name="txtDuration"  class="form-control input-md" value="' + json[0].EmployeeName + ' " readonly>');
                $('#txtBookedon').append(' <label for="service name">Booked On ' + json[0].mydate + '</label>');

                if (json[0].BookingType == "Evoucher") {
                    //  $('#paidstatus').append("<label style='padding-left:80px'>Unpaid</label>");
                    $('#PaymentStatus').append('<input type="text" name="txtDuration"  class="form-control input-md" value="&pound; ' + json[0].Price + ' " readonly>');
                }
                else {
                    // $('#paidstatus').append("<label style='padding-left:80px'>Paid</label>");
                    $('#PaymentStatus').append('<input type="text" name="txtDuration"  class="form-control input-md" value="&pound; ' + json[0].ServicePrice + ' " readonly>');
                }
                if (IsActive == 4) {

                }
                else if (IsActive == 2) {


                }

                else {
                    var Servertime = localStorage.getItem("ServerTime");
                    var ts = new Date(Servertime);
                    var my = [];
                    my = json[0].BookingTime.split(":")

                    var mt = [];
                    mt = json[0].BookingDate.split("-");
                    var mydate = mt[1] + "- " + mt[0] + "- " + mt[2]

                    var tmt = new Date(mydate);

                    var t = tmt.setHours(my[0]);
                    var m = tmt.setMinutes(my[1]);



                    $('#btnCancel').append('<button type="button"  class="btn btn-primary" onclick=CancelOrder(' + SalonCheckoutId + ') data-dismiss="modal">Cancel Order</button>')
                    if (tmt < ts) {
                        $('#btnNoshow').append('<button type="button"  class="btn btn-primary" onclick=NoShowOrder(' + SalonCheckoutId + ')  data-dismiss="modal">No Show</button>')
                    }
                    $('#btnComplete').append('<button type="button"  class="btn btn-primary"  onclick=CompleteOrder(' + SalonCheckoutId + ',\'' + PaymentType + '\',\'' + PaymentsId + '\') data-dismiss="modal">Complete</button>')
                }



            }
        });
    }

    //function CancelOrder(SalonCheckoutId) {


    //    $.ajax({
    //        type: 'GET',
    //        url: 'http://hogarbarber.developerscode.in/' + 'api/SalonCheckout/UpdateStatus',
    //        data: {
    //            "Status": 2, "UpdatedBy": UserId,
    //            "SalonCheckoutId": SalonCheckoutId
    //        },
    //        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
    //        xhrFields: {
    //            withCredentials: false
    //        },

    //        success: function (data) {

    //            if (data[0].Message == "Success") {
    //                GetAll();
    //            }
    //        }
    //    });
    //}

    function NoShowOrder(SalonCheckoutId) {


        $.ajax({
            type: 'GET',
            url: 'http://hogarbarber.developerscode.in/' + 'api/SalonCheckout/UpdateStatus',
            data: {
                "Status": 3, "UpdatedBy": UserId,
                "SalonCheckoutId": SalonCheckoutId
            },
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },

            success: function (data) {

                if (data[0].Message == "Success") {
                    GetdateBasedonDateRange();
                }
            }
        });
    }

    function CompleteOrder(SalonCheckoutId, PaymentType, PaymentsId) {


        if (PaymentType == "PAYATVENUE") {
            var Status = 4;
            var PaymentStatus = "Paid";
        }
        else {
            var Status = 4;
            var PaymentStatus = "Paid";
        }
        $.ajax({
            type: 'GET',
            url: 'http://hogarbarber.developerscode.in/' + 'api/Payment/Complete',
            //url: 'localhost:51133' + 'api/Payment/Complete',
            data: {
                "PaymentStatus": PaymentStatus, "IsActive": Status, "UpdatedBy": UserId, "PaymentsId": PaymentsId,
                "SalonCheckoutId": SalonCheckoutId
            },
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },

            success: function (data) {

                if (data[0].Message == "Success") {

                    GetdateBasedonDateRange();
                }
            }
        });
    }


    function CancellationPolicy(SalonsId) {

        $.ajax({
            type: 'GET',
            url: 'http://hogarbarber.developerscode.in/api/Policy/GetPolicybySalonId?SalonsId=' + SalonsId,
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },
            success: function (data) {

                if (data[0].Message == "Success") {
                    var cancellationtime = data[0].CancellationPolicy;
                    cancellationtime = cancellationtime.slice(0, -9);

                    localStorage.setItem("cancellationtime", cancellationtime);
                    // var btime = $('#lblBookingTime').text();
                    // var d = new Date();
                    // d.setHours(d.getHours() - 2);
                    // $('#lblPolicy1').text("Free cancellation / re-scheduling before " + $('#lblBookingDate').text() + ", 08:10 AM")
                    //  $('#lblPolicy2').text("Free cancellation / re-scheduling before " + $('#lblBookingDate').text() + ", 08:10 AM")
                }
            }
        });
    }

    function GetServerDateTime() {
        $.ajax({
            type: 'GET',
            url: 'http://hogarbarber.developerscode.in/api/BusinessHours/GetServerDateTime',
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            xhrFields: {
                withCredentials: false
            },
            success: function (data) {
                var today = new Date(data);
                var dd = today.getDate();
                var mm = today.getMonth() + 1; //January is 0!
                var yyyy = today.getFullYear();
                if (dd < 10) {
                    dd = '0' + dd
                }
                if (mm < 10) {
                    mm = '0' + mm
                }
                var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();

                today = dd + '-' + mm + '-' + yyyy;
                localStorage.setItem("ServerDate", today);

                localStorage.setItem("ServerTime", data);

                // document.getElementById("selectedDate").setAttribute("min", today);

                //$('#myselecteddate').val(today);
                //00000$('#myselectedtime').val(time);
            }
        });
    }


    //function ConfirmDialog(message, SalonCheckoutId) {
    //    $('<div></div>').appendTo('body')
    //                    .html('<div><h6>' + message + '?</h6></div>')
    //                    .dialog({
    //                        modal: true, title: 'Delete message', zIndex: 0, autoOpen: true,
    //                        width: 'auto', resizable: false,
    //                        buttons: {
    //                            Yes: function () {

    //                                $(this).dialog("close");
    //                                $.ajax({
    //                                    type: 'GET',

    //                                    data: {
    //                                        "Status": 2, "UpdatedBy": UserId,
    //                                        "SalonCheckoutId": SalonCheckoutId
    //                                    },
    //                                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
    //                                    xhrFields: {
    //                                        withCredentials: false
    //                                    },

    //                                    success: function (data) {
    //                                        if (data[0].Message == "Success") {

    //                                            GetAdminEmail();
    //                                            GetVenueEmail();
    //                                            GetCustomerEmail();

    //                                            $('#txtErrorStatus').text('Your Booking is Cancelled Successfully');
    //                                            $('#myModal3').css("display", "block");

    //                                            if (localStorage.getItem("BookingType") == "EVoucher") {
    //                                                CancellationPolicy2();
    //                                            }
    //                                            else {
    //                                                CancellationPolicy();
    //                                            }
    //                                            Cancellation();

    //                                        }
    //                                    }
    //                                })
    //                            },
    //                            No: function () {

    //                                $(this).dialog("close");
    //                            }
    //                        },
    //                        close: function (event, ui) {
    //                            $(this).remove();
    //                        }
    //                    });
    //};


    function CancelOrder(SalonCheckoutId) {


        if (confirm('Are you sure you want to cancel this service?')) {
          


            var cancellationtime = localStorage.getItem("cancellationtime");
            var bookingdate = $("#userdate").val();
            var bookingtime = $("#usertime").val();

            var my = [];
            my = bookingdate.split("-");
            //var bookingdate = my[1] + "-" + my[0] + "-" + my[2];
            var bookingdate = my[2] + "/" + my[1] + "/" + my[0];
            var mybook = new Date(bookingdate);

            var mt = []
            mt = bookingtime.split(":");
            var t = mybook.setHours(mt[0]);
            var m = mybook.setMinutes(mt[1]);


            var server = localStorage.getItem("ServerTime")
            var serverdate = new Date(server);

            var timediff = (mybook - serverdate) / (1000 * 60 * 60);
            // alert(timediff);

            if (cancellationtime < timediff) {

                $.ajax({
                    type: 'GET',
                    url: 'http://hogarbarber.developerscode.in/' + 'api/SalonCheckout/UpdateStatus',
                    data: {
                        "Status": 2, "UpdatedBy": UserId,
                        "SalonCheckoutId": SalonCheckoutId
                    },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    xhrFields: {
                        withCredentials: false
                    },

                    success: function (data) {
                        if (data[0].Message == "Success") {

                            // alert("Your Booking is Cancelled Successfully");
                            $("#myModal3").css('display', "block");
                            $("#lblupdated").text("Your Booking is Cancelled Successfully");
                            GetdateBasedonDateRange();
                        }
                    }
                })
            }

            else {

                //  alert("You have to cancel a service before " + cancellationtime + " hours before from your booking time")
                $("#myModal6").css('display', "block");
                $("#lblupdated1").text("You have to cancel a service before " + cancellationtime + " hours before from your booking time");

            }




        } else {
           
        }





    }

</script>