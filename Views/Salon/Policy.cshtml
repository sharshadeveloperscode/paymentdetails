
@{
    ViewBag.Title = "Policy";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section class="content-header">
    <h1>
        Policy
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i>Home</a></li>
        <li><a href="#">Policy</a></li>
    </ol>
</section>

<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box">
                <!-- /.box-header -->
                <div class="box-body">
                   <!-- The timeline -->
                    <section class="container">
                        <div class="row">
                            <h4>Additional Section</h4>
                    @*<form method="POST" action="#" accept-charset="UTF-8" class="form-horizontal" id="policies">*@
                        <input name="_token" type="hidden">
                            <form class="form-horizontal" id="policies">
                                <fieldset>
                                    <div class="form-group" >
                                        <div class="col-md-3">
                                            <label class="control-label" style="margin-left:60%;">Pay at venue</label>
                                            </div>
                                        <div class="col-md-9 col-sm-9 col-xs-12">
                                            <div class="radio radio-inline">
                                                <label>
                                                    <input type="radio" id="PayAtVenueYes" name="Payatvenue" value="1">
                                                  Yes
                                                </label>
                                            </div>
                                            <div class="radio radio-inline">
                                                <label>
                                                    <input type="radio" id="PayAtVenueNo" name="Payatvenue" value="0">
                                                    No
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    @*<div class="form-group">
                                        <div class="col-md-3">
                                            <label class="control-label" style="margin-left:26%;">Need Booking Confirmation</label>
                                        </div>
                                        <div class="col-md-9 col-sm-9 col-xs-12">
                                            <div class="radio radio-inline">
                                                <label>
                                                    <input type="radio" id="BookingConfirmationYes" name="BookingConfirmation" value="1">
                                                   Yes
                                                </label>
                                            </div>
                                            <div class="radio radio-inline">
                                                <label>
                                                    <input id="BookingConfirmationNo" type="radio" name="BookingConfirmation" value="0">
                                                    No
                                                </label>
                                            </div>
                                        </div>
                                    </div>*@



</fieldset>
                            </form>
                       
                        @*<div class="form-group">
                            <div class="col-sm-6 col-mar-1">
                                <label>Pay at venue</label><br>
                                <div class="radio-inline">
                                    <label>
                                        <input type="radio" id="PayAtVenueYes" name="Payatvenue" value="1">Yes
                                    </label>

                                </div>
                                <div class="radio-inline">
                                    <label>
                                        <input id="PayAtVenueNo" type="radio" name="Payatvenue" value="0">
                                        No
                                    </label>
                                </div>
                            </div>
                            <div class="col-sm-6 col-mar-1">
                                <label>Need Booking Confirmation</label><br>
                                <div class="radio-inline">
                                    <label>
                                        <input type="radio" id="BookingConfirmationYes" name="BookingConfirmation" value="1">Yes
                                    </label>
                                </div>
                                <div class="radio-inline">
                                    <label>
                                        <input id="BookingConfirmationNo" type="radio" name="BookingConfirmation" value="0">
                                        No
                                    </label>
                                </div>
                            </div>


                        </div>*@
                        </div>
                    
                    </section>

                   @* 2nd part *@
                    <div class="container">
                        <div class="row">
                            <h4>Appointment policies</h4>
                    <form class="form-horizontal" style="margin-top: 30px;" >
                        <fieldset>
                            <div class="form-group">
                                <label class="col-md-3 control-label">Cancellation policy</label>
                                <div class="col-md-6 inputGroupContainer">
                                    <select id="ddlCancellationpolicy" class="form-control">
                                        <option value="o">--Select--</option>

                                    </select>
                                </div>
                            </div>


                            <div class="form-group">
                                <label class="col-md-3 control-label">Evoucher Booking Cancellation Policy</label>
                                <div class="col-md-6 inputGroupContainer">
                                    <select id="ddlEvoucherPolicy" class="form-control">
                                        @*<option value="1 Hour">1 Hour</option>
            <option value="2 Hour">2 Hour</option>
            <option value="3 Hour">3 Hour</option>
            <option value="4 Hour">4 Hour</option>
            <option value="5 Hour">5 Hour</option>
            <option value="6 Hour">6 Hour</option>
            <option value="7 Hour">7 Hour</option>
            <option value="8 Hour">8 Hour</option>*@
                                        @*<option value="1 Days">1 Days</option>
            <option value="2 Days">2 Days</option>
            <option value="3 Days">3 Days</option>
            <option value="4 Days">4 Days</option>
            <option value="5 Days">5 Days</option>*@
                                      
                                        <option value="4 Week">4 Weeks</option>
                                        <option value="5 Week">5 Weeks</option>
                                        <option value="6 Week">6 Weeks</option>
                                        <option value="7 Week">7 Weeks</option>
                                        <option value="8 Week">8 Weeks</option>
                                    </select>
                                    <input type="text" hidden id="txtEvoucherPolicyId" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-3 control-label">Booking lead time for appointments</label>
                                <div class="col-md-6 inputGroupContainer">
                                    <select id="ddlLeadAppointments"  class="form-control">
                                        <option value="0 Hour">No closeout</option>
                                        <option value="1 Hour">1 Hour</option>
                                        <option value="2 Hour">2 Hour</option>
                                        <option value="3 Hour">3 Hour</option>
                                        <option value="4 Hour">4 Hour</option>
                                        <option value="5 Hour">5 Hour</option>
                                        <option value="6 Hour">6 Hour</option>
                                        <option value="7 Hour">7 Hour</option>
                                        <option value="8 Hour">8 Hour</option>
                                        <option value="1 Days">1 Days</option>
                                        <option value="2 Days">2 Days</option>
                                        <option value="3 Days">3 Days</option>
                                        <option value="4 Days">4 Days</option>
                                        <option value="5 Days">5 Days</option>
                                        <option value="1 Week">1 Week</option>
                                        <option value="2 Week">2 Week</option>
                                        <option value="3 Week">3 Week</option>
                                        <option value="4 Week">4 Week</option>
                                        <option value="5 Week">5 Week</option>
                                    </select>
                                    <input type="text" hidden id="txtPolicyId" />

                                </div>
                            </div>
                        </fieldset>
                    </form>
                            </div>
                    </div>
                    <div class="box-body table-responsive" style="float:right;">
                        <input type="button" id="btnSave" onclick="Save()" value="Save" class="btn btn-primary " style="width:100px;">
                       
                          <input type="button" value="Back" style="width:100px;float:right" class="btn btn-danger" onclick="window.location.href='@Url.Action("BusinessDashboard", "Salon")';" />
                        
                        <input type="button" id="btnUpdate" onclick="Update()" value="Update" class="btn btn-primary" style="width:100px;">
                      

                        <label id="iblPolicy" style="color:green"></label>
                    </div>





                                               @*<h3 style="margin-left: 12px;">Appointment policies</h3>*@
                                                @*<div class="form-group">
                               <label for="inputEmail" style="margin-left:-105px;" class="col-md-3 control-label">Cancellation policy</label>
                                                    <div class="col-md-3"> </div>
                                                    <div class="col-md-4 col-sm-12">

                                                        <select id="ddlCancellationpolicy" class="form-control">
                                                            <option value="o">--Select--</option>

                                                        </select>

                                                    </div>
                                                </div>*@

                                               @*<div class="row">
                                                    <div class="col-md-12">
                                                        <div class="clearfix"></div>
                                                        <div class="form-group">
                                                            <label for="inputEmail3" class="col-md-3 control-label">Evoucher Booking Cancellation Policy</label>
                                                            <div class="col-md-2"> </div>
                                                            <div class="col-md-4">
                                                                <select id="ddlEvoucherPolicy" style="margin-left:-14px;" class="form-control">
                                                                  
                                                                    <option value="4 Week">4 Week</option>
                                                                    <option value="5 Week">5 Week</option>
                                                                    <option value="6 Week">6 Week</option>
                                                                    <option value="7 Week">7 Week</option>
                                                                    <option value="8 Week">8 Week</option>
                                                                </select>
                                                                <input type="text" hidden id="txtEvoucherPolicyId" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12">
                                                        <div class="clearfix"></div>
                                                        <div class="form-group">
                                                            <label for="inputEmail3" class="col-md-3 control-label">Booking lead time for appointments</label>
                                                            <div class="col-md-2"> </div>
                                                            <div class="col-md-4">
                                                                <select id="ddlLeadAppointments" style="margin-left:-14px;" class="form-control">
                                                                    <option value="0">No closeout</option>
                                                                    <option value="1 Hour">1 Hour<p>/1hr</p></option>
                                                                    <option value="2 Hour">2 Hour<p>/2hr</p></option>
                                                                    <option value="3 Hour">3 Hour<p>/3hr</p></option>
                                                                    <option value="4 Hour">4 Hour<p>/4hr</p></option>
                                                                    <option value="5 Hour">5 Hour<p>/5hr</p></option>
                                                                    <option value="6 Hour">6 Hour<p>/6hr</p></option>
                                                                    <option value="7 Hour">7 Hour<p>/7hr</p></option>
                                                                    <option value="8 Hour">8 Hour<p>/8hr</p></option>
                                                                    <option value="1 Days">1 Days</option>
                                                                    <option value="2 Days">2 Days</option>
                                                                    <option value="3 Days">3 Days</option>
                                                                    <option value="4 Days">4 Days</option>
                                                                    <option value="5 Days">5 Days</option>
                                                                    <option value="1 Week">1 Week</option>
                                                                    <option value="2 Week">2 Week</option>
                                                                    <option value="3 Week">3 Week</option>
                                                                    <option value="4 Week">4 Week</option>
                                                                    <option value="5 Week">5 Week</option>
                                                                </select>
                                                                <input type="text" hidden id="txtPolicyId" />
                                                            </div>
                                                        </div>
                                                      
                                                    </div>

                                                </div>*@
                                           

                                       
                                


                             
                           
                          
                        
                  
</div>
                </div>
            </div>
        </div>


    <div id="preloader" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: #fefefe; z-index: 99; height: 110vh;">
        <div id="status" style="width:100%;height:100%; text-align: center; position: absolute; left: 0; top: 30%; background-repeat: no-repeat; background-size: cover cover; background-position: center; margin: 0px 0 0 36px;">
            <div class="preloader-logo"></div>
            <p class="center-text smaller-text" id="p1" style="margin: 0 24px 10px !important;">
                <h2> Loading .. </h2><br />
                <img src="~/img/preload.gif" />
            </p>
        </div>
    </div>
</section>



@*<label id="iblPolicy" style="color:green"></label>
<h2 style="margin-left:30px">Additional Section</h2>

<div style="margin-left:30px">
    <label style="margin-left:30px">Pay at venue</label>
</div>
<div style="margin-left:60px">
    <input type="radio" name="Payatvenue" id="PayAtVenueYes" value="male"> Yes
    <input type="radio" name="Payatvenue" id="PayAtVenueNo" value="female"> No
</div>
<div>
    <label style="margin-left:30px">Need Booking Confirmation</label>
</div>
<div style="margin-left:60px">
    <input type="radio" name="BookingConfirmation" id="BookingConfirmationYes" value="male"> Yes
    <input type="radio" name="BookingConfirmation" id="BookingConfirmationNo" value="female"> No
</div>
<h2 style="margin-left:30px">Appointment policies</h2>
<div tyle="margin-left:60px">
    <label style="margin-left:30px">Cancellation policy</label>
    <select id="ddlCancellationpolicy"  >
        <option value="o">--Select--</option>
    </select>
</div>
<div style="margin-left:01px">
    <label style="margin-left:30px">Booking lead time for appointments</label>
    <select id="ddlLeadAppointments" >
        <option value="o">No closeout</option>
        <option value="1">1 Hour</option>
        <option value="2">2 Hour</option>
        <option value="3">3 Hour</option>
        <option value="4">4 Hour</option>
        <option value="5">5 Hour</option>
        <option value="6">6 Hour</option>
        <option value="7">7 Hour</option>
        <option value="8">8 Hour</option>
        <option value="9">1 Day</option>
        <option value="10">2 Day</option>
        <option value="11">3 Day</option>
        <option value="12">4 Day</option>
        <option value="13">5 Day</option>
        <option value="14">1 Week</option>
        <option value="15">2 Week</option>
        <option value="16">3 Week</option>
        <option value="17">4 Week</option>
        <option value="18">5 Week</option>
    </select>
</div>
<div>
    <input type="text" hidden id="txtPolicyId" />
</div>
<div >
    <input style="margin-left:30px"  type="button" id="btnSave" class="btn btn-success" onclick="Save()" value="Save" />
    <input style="margin-left:30px" type="button" id="btnUpdate" class="btn btn-success" onclick="Update()" value="Update" />
</div>*@
<script type="text/javascript">
    var URL = "@System.Configuration.ConfigurationManager.AppSettings["URL"]";
    var UserId = localStorage.getItem("UserId");
    window.onload=function()
    {
       
        CancellationPolicy();
        
        checkpolicyforsalon();
     
    }

    function checkpolicyforsalon()
    {
        $.ajax({
            type: "GET",
            url: URLLink + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                $.ajax({
                    type: 'GET',
                    url: URL + "api/Policy/GetPolicybySalonId",
                    data: { "SalonsId": SalonsId },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    success: function (json) {
                        $("#preloader").hide();
                        if (json[0].Message == 'Success') {
                            $("#preloader").hide();

                            BindSalons();

                            $("#btnSave").hide();
                            $("#btnUpdate").show();
                        }
                        else if (json[0].Message == 'NoData') {

                            $("#btnSave").show();
                            $('#BookingConfirmationNo').attr('checked', true);
                            $('#PayAtVenueNo').attr('checked', true);
                            $("#btnUpdate").hide();
                        }
                    }
                });
            }
        });
    }



    function CancellationPolicy()
    {
        for(var i=1;i<49;i++)
        {
            if(i==1){
                  $('#ddlCancellationpolicy').append("<option value='"+i+":00 Hours'>"+i+" Hour</option>");
            }
             else{
              $('#ddlCancellationpolicy').append("<option value='"+i+":00 Hours'>"+i+" Hours</option>");
            }
          
        }
    }
    function Save()
    {

       if( $("#PayAtVenueYes").is(':checked'))
       {
           
            var i=1;
       }
       else if ($("#PayAtVenueNo").is(':checked')) {
           var i=0;
       }

       //if( $("#BookingConfirmationYes").is(':checked'))
       //{
       //    var j=1;
       //}
       //else if ($("#BookingConfirmationNo").is(':checked')) {
       //    var j=0;
       //}
    
        $.ajax({
            type: "GET",
            url: URLLink + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                $.ajax({
                    type: 'GET',
                    url: URLLink + "api/Policy/InsertPolicy",
                    data: { "SalonsId": SalonsId, "PayAtVenue": i, "NeedBookingConfirmation": 0, "CancellationPolicy": $("#ddlCancellationpolicy").val(), "BookingleadtimeforAppointments": $("#ddlLeadAppointments").val(), "IsActive": 1, "CreatedBy": UserId, "EvoucherCancellation": $("#ddlEvoucherPolicy").val() },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    xhrFields: {
                        withCredentials: false
                    },
                    success: function (json) {
                        checkpolicyforsalon();
                        //  $("#iblPolicy").text("Policy information Added successfully.")
                        StatusMessage(1);
                       
                    }
                });
            }
        });
    }

    function Update()
    {
       // alert($("#ddlLeadAppointments option:selected").text());
      
        if( $("#PayAtVenueYes").is(':checked'))
        {
           
            var i=1;
        }
        else if ($("#PayAtVenueNo").is(':checked')) {
            var i=0;
        }

        //if( $("#BookingConfirmationYes").is(':checked'))
        //{
        //    var j=1;
        //}
        //else if ($("#BookingConfirmationNo").is(':checked')) {
        //    var j=0;
        //}
        $.ajax({
            type: "GET",
            url: URL + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                $.ajax({
                    type: 'GET',
                    url: URLLink + "api/Policy/UpdatePolicy",
                    data: { "SalonsId": SalonsId, "PayAtVenue": i, "NeedBookingConfirmation": 0, "CancellationPolicy": $("#ddlCancellationpolicy").val(), "BookingleadtimeforAppointments": $("#ddlLeadAppointments").val(), "IsActive": 1, "UpdatedBy": UserId, "PolicyId": $("#txtPolicyId").val(), "EvoucherCancellation": $("#ddlEvoucherPolicy").val() },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    xhrFields: {
                        withCredentials: false
                    },
                    success: function (json) {
                       
                      //  $("#iblPolicy").text("Policy information added successfully.");
                        StatusMessage(2);
                    }
                });
            }
        });
    }

    function BindSalons() {
        $.ajax({
            type: "GET",
            url: URL + "api/Salons/GetSalonIdByUserId",
            data: { "UserId": UserId },
            cache: false,
            success: function (json) {
                var SalonsId = json[0].SalonsId;
                $.ajax({
                    type: 'GET',
                    url: URL + "api/Policy/GetPolicybySalonId",
                    data: { "SalonsId": SalonsId },
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache: false,
                    success: function (json) {

                       
                        $("#ddlCancellationpolicy").val(json[0].CancellationPolicy);
                       // $("#ddlCancellationpolicy option:selected").text(json[0].CancellationPolicy);
                        $("#ddlLeadAppointments").val(json[0].BookingleadtimeforAppointments);
                        $("#ddlEvoucherPolicy").val(json[0].EvoucherCancellation);
                        $("#txtPolicyId").val(json[0].PolicyId)
                        if (json[0].PayAtVenue == '1') {
                            $('#PayAtVenueYes').attr('checked', 'checked');
                        }
                        else if (json[0].PayAtVenue == '0') {
                            $("#PayAtVenueNo").attr('checked', 'checked');
                        }
                        if (json[0].NeedBookingConfirmation == '1') {
                            $("#BookingConfirmationYes").attr('checked', 'checked')
                        }
                        else if (json[0].NeedBookingConfirmation == '0') {
                            $("#BookingConfirmationNo").attr('checked', 'checked')
                        }
                       
                    }
                });
            }
        });
    }

    function  StatusMessage(Message){
        if (Message == "2") {

            $("#myModal3").css('display', "block");
            $("#lblupdated").text("Policy information updated successfully");

        }
        else if (Message == "1") {

            $("#myModal3").css('display', "block");
            $("#lblupdated").text("Policy information added successfully");

        }
    }
</script>
